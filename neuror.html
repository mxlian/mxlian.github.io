<!DOCTYPE html>
<html lang="en">

<head>
  <!-- <link rel="stylesheet/less" type="text/css" href="http://mxlian.github.io/theme/css/style.less">
  <script src="http://mxlian.github.io/theme/js/less-1.3.3.min.js" type="text/javascript"></script> test -->
  <link rel="stylesheet" type="text/css" href="/theme/css/style.css">

  <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width; initial-scale=1.0">
  <meta name="author" content="mxlian">
  <meta name="description" content="Posts and writings by mxlian">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link href="http://mxlian.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="planocomplejo Full Atom Feed" />

<meta name="keywords" content="">

  <title>
Biometric identification using analysis of the angular changes of a door when a person opens it  </title>

</head>

<body>
    <aside style="background: url('/images/back-7sd.jpg') top left no-repeat #4d4d4d;">
    <div id="user_meta">
        <a href="http://mxlian.github.io">
        <img src="/images/complex-plane.png" alt="logo">
      </a>
      <h2><a href="http://mxlian.github.io">planocomplejo</a></h2>
      <p class="tagline">by mxlian</p>
      <div id="social_links">
	<ul id="social_list">
        <li><a href="https://github.com/mxlian" rel='me' target="_blank"><i class="fa fa-github fa-2x"></i></a></li>
        <li><a href="https://twitter.com/mpadulo" rel='me' target="_blank"><i class="fa fa-twitter fa-2x"></i></a></li>
	</ul>
      </div>
      <ul>
        <li><a  href="http://mxlian.github.io/pages/hi-there.html">Hi there</a></li>
        <li><a  href="http://mxlian.github.io/archives.html">Archives</a></li>
       </ul>
    </div>
    <div class="overlay">
    </div>
  </aside>

  <main>
     <header>
<p>Posted on Di 27 Juli 2010</p>
    </header>
<article>
  <div id="article_title">
    <h1><a href="http://mxlian.github.io/neuror.html">Biometric identification using analysis of the angular changes of a door when a person opens it</a></h1>
  </div>
  <div id="article_text">
    <html><body><p>Differences between human beings (physical and psychological) make us interact with our surrounding in a very unique way.</p>
<p>With my friend Julian we thought it may be possible to identify a person entering into a building from the way it opens the building's door, analyzing the angular values over time.</p>
<p><img alt="samples" src="http://mxlian.github.io/images/neuror/samples.png" style="width: 2095px; height: auto; max-width: 100%;"/></p>

<h1>Input</h1>
<p>The first step is to collect some samples, so we can have a nice test set to develop the recognition system.</p>
<p>To feed the system, we wanted to sample the angular position of a door at a fixed rate for a fixed amount of time. This sample will then be used as the 'fingerprint' of the person to be identified.</p>
<p>The experiments took place on a garage door, where only a reduced amount of people has access. </p>
<p>The sensor is a potentiometer with its body fixed, and the moving shaft attached to the door. </p>
<p><img alt="potetiometer" src="http://mxlian.github.io/images/neuror/1.resized.JPG" style="width: 1024px; height: auto; max-width: 100%;"/></p>
<p>The potentiometer is aligned with the door axis, allowing the moving shaft to follow the angular movements of the door.</p>
<p><img alt="potetiometer" src="http://mxlian.github.io/images/neuror/2.resized.JPG" style="width: 576px; height: auto; max-width: 100%;"/></p>
<p>Whenever someone opens the door, the potentiometer will track the movement all the time.</p>
<p><img alt="potetiometer" src="http://mxlian.github.io/images/neuror/3.resized.JPG" style="width: 576px; height: auto; max-width: 100%;"/></p>
<p>The signals of the potentiometer are collected with an arduino (my self made Severino version :), digitalized an sent to a PC where it's stored in a database.</p>
<p><img alt="arduino" src="http://mxlian.github.io/images/neuror/4.resized.JPG" style="width: 1024px; height: auto; max-width: 100%;"/></p>
<p>The arduino runs a sketch wich performs the following:</p>
<ul>
<li>It calibrates the value of the door closed</li>
<li>Detects when the door starts to open</li>
<li>When its opened<ul>
<li>Measure the potentiometer signal </li>
<li>Send this signal to the computer immediately (there is no enough memory on the arduino to store large samples)</li>
<li>Wait a fixed amount of time before the next reading</li>
</ul>
</li>
<li>When the door closes send a special character to signalize the pc that the sampling finished (and it can be saved on the DB)</li>
</ul>
<p>The code of the sketch looks like this:</p>
<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">       Neuror - Door Interface Sketch </span>
<span class="cm">*/</span>

<span class="c1">/// Parametros de funcionamiento ///</span>
<span class="p">#</span><span class="n">define</span> <span class="n">Tolerancia</span> <span class="mh">7</span>
<span class="p">#</span><span class="n">define</span> <span class="n">PinAnalogico</span> <span class="mh">0</span>
<span class="p">#</span><span class="n">define</span> <span class="n">PinLedIndicador</span> <span class="mh">13</span>
<span class="p">#</span><span class="n">define</span> <span class="n">TiempoEntreMuestras</span> <span class="mh">20</span> <span class="c1">// Valor en ms. + lo q toma enviar </span>
                               <span class="c1">// los 2/3/4/5 bytes por serial.</span>

<span class="k">int</span> <span class="n">valorAD</span><span class="p">;</span>
<span class="k">int</span> <span class="n">valorMinimo</span> <span class="o">=</span> <span class="mh">1023</span><span class="p">;</span>        <span class="c1">// Para forzar una recalibracion</span>
<span class="k">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>

<span class="k">void</span> <span class="n">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="k">begin</span><span class="p">(</span><span class="mh">9600</span><span class="p">);</span> 
    <span class="n">pinMode</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">OUTPUT</span><span class="p">);</span>

    <span class="c1">// Serial.println("READY!");</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">HIGH</span><span class="p">);</span>   <span class="c1">// Mostar q ya empieza el programa</span>
    <span class="n">delay</span><span class="p">(</span><span class="mh">1000</span><span class="p">);</span>                  
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>


    <span class="c1">/// RUTINA RECALIBRACION ///</span>
    <span class="n">valorAD</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">PinAnalogico</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">((</span><span class="n">valorAD</span><span class="o">-</span><span class="n">valorMinimo</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="p">(</span><span class="n">Tolerancia</span><span class="o">/</span><span class="mh">2</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// Hay q recalibrar el minimo</span>
        <span class="k">if</span> <span class="p">((</span><span class="mh">1023</span><span class="o">-</span><span class="n">valorAD</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Tolerancia</span><span class="p">)</span> <span class="p">{</span>          <span class="c1">// Si el minimo esta demasiado </span>
                                                    <span class="c1">// cerca del limite superior del </span>
                                                    <span class="c1">// CAD no hay q establecerlo </span>
                                                    <span class="c1">// tan cerca.</span>
          <span class="n">valorMinimo</span> <span class="o">=</span> <span class="n">valorAD</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">valorMinimo</span> <span class="o">=</span><span class="mh">1023</span> <span class="o">-</span> <span class="n">Tolerancia</span> <span class="o">-</span><span class="mh">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Prendemos el led para mostar q se recalibro</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>  
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">HIGH</span><span class="p">);</span>   
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>                  
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>   
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">HIGH</span><span class="p">);</span>   
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>                  
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>   
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">HIGH</span><span class="p">);</span>   
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>                  
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mh">300</span><span class="p">);</span>  
    <span class="p">}</span>
    <span class="c1">/// RUTINA RECALIBRACION ///</span>
<span class="p">}</span>

<span class="k">void</span> <span class="n">loop</span><span class="p">()</span> <span class="p">{</span>

    <span class="n">valorAD</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">PinAnalogico</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">((</span><span class="n">valorAD</span><span class="o">-</span><span class="n">valorMinimo</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">Tolerancia</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">LOW</span><span class="p">);</span>

        <span class="k">while</span><span class="p">((</span><span class="n">valorAD</span><span class="o">-</span><span class="n">valorMinimo</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">Tolerancia</span><span class="p">){</span> 
          <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">valorAD</span><span class="p">);</span>
          <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
          <span class="n">delay</span><span class="p">(</span><span class="n">TiempoEntreMuestras</span><span class="p">);</span>
          <span class="n">valorAD</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">PinAnalogico</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"x"</span><span class="p">);</span>  <span class="c1">// Esto indica el fin del sample</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>   <span class="c1">// Esto indica el fin de la transmision</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">PinLedIndicador</span><span class="p">,</span> <span class="no">HIGH</span><span class="p">);</span>  
    <span class="p">}</span>
    <span class="n">delay</span><span class="p">(</span><span class="mh">10</span><span class="p">);</span>    
<span class="p">}</span>
</pre></div>
<p>The data is received on a PC through the serial port, where a python script is constantly waiting for data and putting in a SQLite database whenever it's available.</p>
<p><img alt="pc" src="http://mxlian.github.io/images/neuror/5.resized.JPG" style="width: 720px; height: auto; max-width: 100%;"/></p>
<p>The script will:</p>
<ul>
<li>Connect to the database and get a cursor</li>
<li>Open the serial port</li>
<li>Go in a loop where:<ul>
<li>It receives each reading until a <code>newline</code> character signalizes the end of the sampling </li>
<li>Store the sample on the database</li>
</ul>
</li>
</ul>
<p>NOTE: The <code>readline()</code> function of the Serial library blocks until the newline character appears on the line.</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">datetime</span>
<span class="n">import</span> <span class="n">serial</span>
<span class="n">import</span> <span class="n">sqlite3</span>
<span class="n">import</span> <span class="n">time</span>

<span class="n">connection</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="err">'</span><span class="n">puerta</span><span class="o">-</span><span class="n">datos</span><span class="p">.</span><span class="n">db</span><span class="err">'</span><span class="p">,</span> <span class="n">detect_types</span><span class="o">=</span><span class="n">sqlite3</span><span class="p">.</span><span class="n">PARSE_DECLTYPES</span><span class="o">|</span><span class="n">sqlite3</span><span class="p">.</span><span class="n">PARSE_COLNAMES</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="cp">## To create the database the first time uncomment this</span>
<span class="cp">#print "Creando base de datos..."</span>
<span class="cp">#cursor.execute('DROP TABLE datos')</span>
<span class="cp">#cursor.execute('CREATE TABLE datos (id INTEGER PRIMARY KEY, fecha TIMESTAMP, datos VARCHAR(320))')  #320 ==&gt; "9999-"x64</span>
<span class="cp">#connection.commit()</span>

<span class="cp">## To print all the data use this</span>
<span class="cp">#print "Visualizando datos:"</span>
<span class="cp">#cursor.execute('SELECT * FROM datos')</span>
<span class="cp">#for row in cursor:</span>
<span class="cp">#    print row</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">serial</span><span class="p">.</span><span class="n">Serial</span><span class="p">(</span><span class="err">'</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyS0</span><span class="err">'</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>
<span class="n">print</span> <span class="s">"Port in use:"</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">portstr</span>

<span class="k">while</span> <span class="n">True</span><span class="o">:</span>
    <span class="n">cursor</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="err">'</span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">datos</span><span class="p">(</span><span class="n">fecha</span><span class="p">,</span> <span class="n">datos</span><span class="p">)</span> <span class="n">values</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span> <span class="o">?</span><span class="p">)</span><span class="err">'</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">s</span><span class="p">.</span><span class="n">readline</span><span class="p">())</span>
                  <span class="p">)</span>
    <span class="n">connection</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>

<span class="cp">#cursor.close()</span>
<span class="cp">#connection.close()</span>
<span class="cp">#s.close()</span>
</pre></div>
<h1>Samples</h1>
<p>The samples obtained were very very nice. You can tell just by looking at them, the different patters that appear.</p>
<p>See the picture at the beginning of the article.</p>
<p><img alt="samples" src="http://mxlian.github.io/images/neuror/sample47.png" style="width: 2095px; height: auto; max-width: 100%;"/>
<img alt="samples" src="http://mxlian.github.io/images/neuror/sample49.png" style="width: 2095px; height: auto; max-width: 100%;"/></p>
<h1>Analysis</h1>
<p>Julian started to train some neuronal networks to be able to recognize and group the patterns. He worked with Kohonnen maps.</p>
<p>Sadly we had to quit the project because we got another priorities and we end up abandon the project.</p>
<p>UPDATE: I put some of the stuff on <a href="//github.com/mxlian/neuror">GitHub</a> if case you're interested</p></body></html>
  </div>
  <div id="article_meta">
  	<p>Author: <a href="http://mxlian.github.io/author/mxlian.html">mxlian</a></p>
    <p>Category: <a href="http://mxlian.github.io/category/misc.html">misc</a></p>
  </div>
    <div class="comments">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "neuror.html";
        var disqus_url = "http://mxlian.github.io/neuror.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://planocomplejo.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
</article>

    <footer> 
<p><a href="http://mxlian.github.io/" class="button_accent">&larr; Back to Index</a></p>
    </footer>

    <div id="ending_message">
      <p>&copy mxlian, member of the <a href="http://internetdefenseleague.org">Internet Defense League</a>. Site built with <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme forked from <a href="https://github.com/mxlian/perec" target="_blank">perec</a></p>
    </div>
  </main>
<script type="text/javascript">
  window._idl = {};
  _idl.variant = "banner";
  (function() {
    var idl = document.createElement('script');
    idl.type = 'text/javascript';
    idl.async = true;
    idl.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'members.internetdefenseleague.org/include/?url=' + (_idl.url || '') + '&campaign=' + (_idl.campaign || '') + '&variant=' + (_idl.variant || 'banner');
    document.getElementsByTagName('body')[0].appendChild(idl);
  })();
</script>
</body>
</html>